CREATE VIEW pbi.vw_DimEthnicity
AS 

SELECT     dl.LookupID AS EthnicityID, dl.LookupValue, 
		   CASE WHEN trim(dlPar.LookupText) IS NOT NULL   THEN (dlPar.LookupText + ' ' + dl.LookupText)
		        ELSE IsNull(dl.LookupText, 'Not Set') 
		   END  AS Ethnicity,
		     
           dl.LookupSortIndex AS SortIndex,
           CASE 
WHEN dlPar.LookupText = 'Maori'                                                                                                           THEN 'Maori'    -- i.e. if parent group is Maori
WHEN dl.LookupText = 'African'                                                                                                            THEN 'Other'
WHEN dl.LookupText = 'Aotea '                                                                                                             THEN 'Maori'
WHEN dl.LookupText = 'Australian'                                                                                                         THEN 'Other'
WHEN dl.LookupText = 'Chinese'                                                                                                            THEN 'Asian'
WHEN dl.LookupText = 'Filipino'                                                                                                           THEN 'Asian'
WHEN dl.LookupText = 'Greek (including Greek Cypriot)'                                                                                    THEN 'European'
WHEN dl.LookupText = 'Hauraki (Coromandel) Region (nfd) '                                                                                 THEN 'Maori'
WHEN dl.LookupText = 'Hauraki / Pare Hauraki '                                                                                            THEN 'Maori'
WHEN dl.LookupText = 'Horouta '                                                                                                           THEN 'Maori'
WHEN dl.LookupText = 'Kati Mamoe '                                                                                                        THEN 'Maori'
WHEN dl.LookupText = 'Khmer/Kampuchean/Cambodian'                                                                                         THEN 'Asian'
WHEN dl.LookupText = 'Korean'                                                                                                             THEN 'Asian'
WHEN dl.LookupText = 'Kurahaupo '                                                                                                         THEN 'Maori'
WHEN dl.LookupText = 'Manawatu/Horowhenua/Te Whanganui-a-Tara (Manawatu/Horowhenua/Wellington) Region nfd '                               THEN 'Maori'
WHEN dl.LookupText = 'Maori'                                                                                                              THEN 'Maori'
WHEN dl.LookupText = 'Mataatua '                                                                                                          THEN 'Maori'
WHEN dl.LookupText = 'Moriori '                                                                                                           THEN 'Maori'
WHEN dl.LookupText = 'Muaupoko '                                                                                                          THEN 'Maori'
WHEN dl.LookupText = 'Nga Rauru '                                                                                                         THEN 'Maori'
WHEN dl.LookupText = 'Nga Ruahine '                                                                                                       THEN 'Maori'
WHEN dl.LookupText = 'Ngai Tahu / Kai Tahu '                                                                                              THEN 'Maori'
WHEN dl.LookupText = 'Ngai Tai (Hauraki) '                                                                                                THEN 'Maori'
WHEN dl.LookupText = 'Ngai Tai (Tauranga Moana/Mataatua) '                                                                                THEN 'Maori'
WHEN dl.LookupText = 'Ngai Takoto '                                                                                                       THEN 'Maori'
WHEN dl.LookupText = 'Ngaiterangi '                                                                                                       THEN 'Maori'
WHEN dl.LookupText = 'Ngapuhi ki Whaingaroa-Ngati Kahu ki Whaingaroa'                                                                     THEN 'Maori'
WHEN dl.LookupText = 'Ngati Apa (Rangitikei) '                                                                                            THEN 'Maori'
WHEN dl.LookupText = 'Ngati Apa, area unspecified '                                                                                       THEN 'Maori'
WHEN dl.LookupText = 'Ngati Hako '                                                                                                        THEN 'Maori'
WHEN dl.LookupText = 'Ngati Haua, region unspecified '                                                                                    THEN 'Maori'
WHEN dl.LookupText = 'Ngati Hauiti '                                                                                                      THEN 'Maori'
WHEN dl.LookupText = 'Ngati Kahu'                                                                                                         THEN 'Maori'
WHEN dl.LookupText = 'Ngati Kahungunu ki Heretaunga '                                                                                     THEN 'Maori'
WHEN dl.LookupText = 'Ngati Kahungunu ki Tamatea '                                                                                        THEN 'Maori'
WHEN dl.LookupText = 'Ngati Kahungunu ki Wairarapa '                                                                                      THEN 'Maori'
WHEN dl.LookupText = 'Ngati Kahungunu ki Whanganui-a-Orotu '                                                                              THEN 'Maori'
WHEN dl.LookupText = 'Ngati Kahungunu, region unspecified '                                                                               THEN 'Maori'
WHEN dl.LookupText = 'Ngati Kuia '                                                                                                        THEN 'Maori'
WHEN dl.LookupText = 'Ngati Kuri'                                                                                                         THEN 'Maori'
WHEN dl.LookupText = 'Ngati Manawa '                                                                                                      THEN 'Maori'
WHEN dl.LookupText = 'Ngati Maniapoto '                                                                                                   THEN 'Maori'
WHEN dl.LookupText = 'Ngati Maru (Taranaki) '                                                                                             THEN 'Maori'
WHEN dl.LookupText = 'Ngati Maru, region unspecified '                                                                                    THEN 'Maori'
WHEN dl.LookupText = 'Ngati Mutunga (Taranaki) '                                                                                          THEN 'Maori'
WHEN dl.LookupText = 'Ngati Mutunga (Wharekauri/Chatham Islands) '                                                                        THEN 'Maori'
WHEN dl.LookupText = 'Ngati Mutunga, region unspecified '                                                                                 THEN 'Maori'
WHEN dl.LookupText = 'Ngati Paoa '                                                                                                        THEN 'Maori'
WHEN dl.LookupText = 'Ngati Pikiao (Te Arawa) '                                                                                           THEN 'Maori'
WHEN dl.LookupText = 'Ngati Porou '                                                                                                       THEN 'Maori'
WHEN dl.LookupText = 'Ngati Porou ki Harataunga ki Mataora '                                                                              THEN 'Maori'
WHEN dl.LookupText = 'Ngati Rakaipaaka '                                                                                                  THEN 'Maori'
WHEN dl.LookupText = 'Ngati Rangitihi (Te Arawa) '                                                                                        THEN 'Maori'
WHEN dl.LookupText = 'Ngati Rangiwewehi (Te Arawa) '                                                                                      THEN 'Maori'
WHEN dl.LookupText = 'Ngati Rarua '                                                                                                       THEN 'Maori'
WHEN dl.LookupText = 'Ngati Raukawa (Horowhenua/Manawatu) '                                                                               THEN 'Maori'
WHEN dl.LookupText = 'Ngati Raukawa (Waikato) '                                                                                           THEN 'Maori'
WHEN dl.LookupText = 'Ngati Raukawa, region unspecified '                                                                                 THEN 'Maori'
WHEN dl.LookupText = 'Ngati Ruanui '                                                                                                      THEN 'Maori'
WHEN dl.LookupText = 'Ngati Tahu-Ngati Whaoa (Te Arawa) '                                                                                 THEN 'Maori'
WHEN dl.LookupText = 'Ngati Tama (Te Waipounamu/South Island) '                                                                           THEN 'Maori'
WHEN dl.LookupText = 'Ngati Tamatera '                                                                                                    THEN 'Maori'
WHEN dl.LookupText = 'Ngati Tara Tokanui '                                                                                                THEN 'Maori'
WHEN dl.LookupText = 'Ngati Toa, region unspecified '                                                                                     THEN 'Maori'
WHEN dl.LookupText = 'Ngati Toarangatira (Te Whanganui a Tara/Wellington) '                                                               THEN 'Maori'
WHEN dl.LookupText = 'Ngati Wai '                                                                                                         THEN 'Maori'
WHEN dl.LookupText = 'Ngati Whakaue (Te Arawa) '                                                                                          THEN 'Maori'
WHEN dl.LookupText = 'Ngati Whare '                                                                                                       THEN 'Maori'
WHEN dl.LookupText = 'Ngati Whatua '                                                                                                      THEN 'Maori'
WHEN dl.LookupText = 'Pakakohi '                                                                                                          THEN 'Maori'
WHEN dl.LookupText = 'Polish'                                                                                                             THEN 'European'
WHEN dl.LookupText = 'Rangitane '                                                                                                         THEN 'Maori'
WHEN dl.LookupText = 'Rangitane (Manawatu) '                                                                                              THEN 'Maori'
WHEN dl.LookupText = 'Rangitane (Te Matau a Maui/Hawke''s Bay/Wairarapa) '                                                                THEN 'Maori'
WHEN dl.LookupText = 'Refused to Answer'                                                                                                  THEN 'NOT SPECIFIED'
WHEN dl.LookupText = 'Response outside scope '                                                                                            THEN 'NOT SPECIFIED'
WHEN dl.LookupText = 'Response Unidentifiable'                                                                                            THEN 'NOT SPECIFIED'
WHEN dl.LookupText = 'Rongowhakaata '                                                                                                     THEN 'Maori'
WHEN dl.LookupText = 'South Slav (formerly Yugoslav)'                                                                                     THEN 'European'
WHEN dl.LookupText = 'Southeast Asian'                                                                                                    THEN 'Asian'
WHEN dl.LookupText = 'Southeast Asian NFD'                                                                                                THEN 'Asian'
WHEN dl.LookupText = 'Sri Lankan'                                                                                                         THEN 'Asian'
WHEN dl.LookupText = 'Tainui '                                                                                                            THEN 'Maori'
WHEN dl.LookupText = 'Tapuika (Te Arawa) '                                                                                                THEN 'Maori'
WHEN dl.LookupText = 'Taranaki '                                                                                                          THEN 'Maori'
WHEN dl.LookupText = 'Tarawhai (Te Arawa) '                                                                                               THEN 'Maori'
WHEN dl.LookupText = 'Te Arawa '                                                                                                          THEN 'Maori'
WHEN dl.LookupText = 'Te Arawa/Taupo (Rotorua/Taupo) Region (nfd) '                                                                       THEN 'Maori'
WHEN dl.LookupText = 'Te Ati Haunui-a-Paparangi '                                                                                         THEN 'Maori'
WHEN dl.LookupText = 'Te Atiawa (Taranaki) '                                                                                              THEN 'Maori'
WHEN dl.LookupText = 'Te Atiawa (Te Waipounamu/South Island) '                                                                            THEN 'Maori'
WHEN dl.LookupText = 'Te Atiawa (Te Whanganui a Tara/Wellington) '                                                                        THEN 'Maori'
WHEN dl.LookupText = 'Te Atiawa, region unspecified '                                                                                     THEN 'Maori'
WHEN dl.LookupText = 'Te Aupouri'                                                                                                         THEN 'Maori'
WHEN dl.LookupText = 'Te Rarawa '                                                                                                         THEN 'Maori'
WHEN dl.LookupText = 'Te Roroa '                                                                                                          THEN 'Maori'
WHEN dl.LookupText = 'Te Tai Tokerau/Tamaki-makaurau (Northland/Auckland) Region (nfd)'                                                   THEN 'Maori'
WHEN dl.LookupText = 'Te Tauihu o Te Waka a Maui '                                                                                        THEN 'Maori'
WHEN dl.LookupText = 'Te Uri-o Hau '                                                                                                      THEN 'Maori'
WHEN dl.LookupText = 'Te Whanau-a-Apanui '                                                                                                THEN 'Maori'
WHEN dl.LookupText = 'Tokomaru '                                                                                                          THEN 'Maori'
WHEN dl.LookupText = 'Tuhourangi (Te Arawa) '                                                                                             THEN 'Maori'
WHEN dl.LookupText = 'Vietnamese'                                                                                                         THEN 'Asian'
WHEN dl.LookupText = 'Waikato '                                                                                                           THEN 'Maori'
WHEN dl.LookupText = 'Waikato/Te Rohe Potae (Waikato/King Country) Region (nfd) '                                                         THEN 'Maori'
WHEN dl.LookupText = 'Waitaha (Te Arawa) '                                                                                                THEN 'Maori'
WHEN dl.LookupText = 'Waitaha (Te Waipounamu/South Island) '                                                                              THEN 'Maori'
WHEN dl.LookupText = 'Asian nfd'                                                                                                          THEN 'Asian'
WHEN dl.LookupText = 'Indian'                                                                                                             THEN 'Asian'
WHEN dl.LookupText = 'Japanese'                                                                                                           THEN 'Asian'
WHEN dl.LookupText = 'Other Asian'                                                                                                        THEN 'Asian'
WHEN dl.LookupText = 'Other Southeast Asian'                                                                                              THEN 'Asian'
WHEN dl.LookupText = 'British and Irish'                                                                                                  THEN 'European'
WHEN dl.LookupText = 'Dutch'                                                                                                              THEN 'European'
WHEN dl.LookupText = 'European nfd'                                                                                                       THEN 'European'
WHEN dl.LookupText = 'German'                                                                                                             THEN 'European'
WHEN dl.LookupText = 'Italian'                                                                                                            THEN 'European'
WHEN dl.LookupText = 'Other European'                                                                                                     THEN 'European'
WHEN dl.LookupText = 'Other European NFD'                                                                                                 THEN 'European'
WHEN dl.LookupText = 'Hapu affiliated to more than one Iwi '                                                                              THEN 'Maori'
WHEN dl.LookupText = 'Ngai Tamanuhiri '                                                                                                   THEN 'Maori'
WHEN dl.LookupText = 'Ngapuhi'                                                                                                            THEN 'Maori'
WHEN dl.LookupText = 'Ngati Awa '                                                                                                         THEN 'Maori'
WHEN dl.LookupText = 'Ngati Haua (Taumarunui) '                                                                                           THEN 'Maori'
WHEN dl.LookupText = 'Ngati Haua (Waikato) '                                                                                              THEN 'Maori'
WHEN dl.LookupText = 'Ngati Kahungunu ki Te Wairoa '                                                                                      THEN 'Maori'
WHEN dl.LookupText = 'Ngati Pahauwera '                                                                                                   THEN 'Maori'
WHEN dl.LookupText = 'Ngati Pukenga '                                                                                                     THEN 'Maori'
WHEN dl.LookupText = 'Ngati Ranginui '                                                                                                    THEN 'Maori'
WHEN dl.LookupText = 'Ngati Tuwharetoa '                                                                                                  THEN 'Maori'
WHEN dl.LookupText = 'Rongomaiwahine (Te Mahia) '                                                                                         THEN 'Maori'
WHEN dl.LookupText = 'Te Aitanga-a-Mahaki '                                                                                               THEN 'Maori'
WHEN dl.LookupText = 'Te Tai Rawhiti (East Coast) Region nfd '                                                                            THEN 'Maori'
WHEN dl.LookupText = 'Tuhoe '                                                                                                             THEN 'Maori'
WHEN dl.LookupText = 'Whakatohea '                                                                                                        THEN 'Maori'
WHEN dl.LookupText = 'Middle Eastern'                                                                                                     THEN 'Other'
WHEN dl.LookupText = 'New Zealand European/Päkehä'                                                                                        THEN 'New Zealand European/Päkehä'
WHEN dl.LookupText = 'Don''t know '                                                                                                       THEN 'Not stated'
WHEN dl.LookupText = 'Not stated'                                                                                                         THEN 'Not stated'
WHEN dl.LookupText = 'Latin American/Hispanic'                                                                                            THEN 'Other'
WHEN dl.LookupText = 'Other'                                                                                                              THEN 'Other'
WHEN dl.LookupText = 'Cook Island Maori'                                                                                                  THEN 'Pacific'
WHEN dl.LookupText = 'Fijian'                                                                                                             THEN 'Pacific'
WHEN dl.LookupText = 'Niuean'                                                                                                             THEN 'Pacific'
WHEN dl.LookupText = 'Other Pacific Peoples'                                                                                              THEN 'Pacific'
WHEN dl.LookupText = 'Pacific Peoples nfd'                                                                                                THEN 'Pacific'
WHEN dl.LookupText = 'Samoan'                                                                                                             THEN 'Pacific'
WHEN dl.LookupText = 'Tokelauan'                                                                                                          THEN 'Pacific'
WHEN dl.LookupText = 'Tongan'                                                                                                             THEN 'Pacific'

                ELSE 'Not Set'
           END  as EthnicityGroup,
CASE 
WHEN dlPar.LookupText = 'Maori'                                                                                                           THEN 'Maori'    -- i.e. if parent group is Maori
WHEN dl.LookupText = 'African'                                                                                                            THEN 'Other'
WHEN dl.LookupText = 'Aotea '                                                                                                             THEN 'Maori'
WHEN dl.LookupText = 'Australian'                                                                                                         THEN 'Other'
WHEN dl.LookupText = 'Chinese'                                                                                                            THEN 'Asian'
WHEN dl.LookupText = 'Filipino'                                                                                                           THEN 'Asian'
WHEN dl.LookupText = 'Greek (including Greek Cypriot)'                                                                                    THEN 'European'
WHEN dl.LookupText = 'Hauraki (Coromandel) Region (nfd) '                                                                                 THEN 'Maori'
WHEN dl.LookupText = 'Hauraki / Pare Hauraki '                                                                                            THEN 'Maori'
WHEN dl.LookupText = 'Horouta '                                                                                                           THEN 'Maori'
WHEN dl.LookupText = 'Kati Mamoe '                                                                                                        THEN 'Maori'
WHEN dl.LookupText = 'Khmer/Kampuchean/Cambodian'                                                                                         THEN 'Asian'
WHEN dl.LookupText = 'Korean'                                                                                                             THEN 'Asian'
WHEN dl.LookupText = 'Kurahaupo '                                                                                                         THEN 'Maori'
WHEN dl.LookupText = 'Manawatu/Horowhenua/Te Whanganui-a-Tara (Manawatu/Horowhenua/Wellington) Region nfd '                               THEN 'Maori'
WHEN dl.LookupText = 'Maori'                                                                                                              THEN 'Maori'
WHEN dl.LookupText = 'Mataatua '                                                                                                          THEN 'Maori'
WHEN dl.LookupText = 'Moriori '                                                                                                           THEN 'Maori'
WHEN dl.LookupText = 'Muaupoko '                                                                                                          THEN 'Maori'
WHEN dl.LookupText = 'Nga Rauru '                                                                                                         THEN 'Maori'
WHEN dl.LookupText = 'Nga Ruahine '                                                                                                       THEN 'Maori'
WHEN dl.LookupText = 'Ngai Tahu / Kai Tahu '                                                                                              THEN 'Maori'
WHEN dl.LookupText = 'Ngai Tai (Hauraki) '                                                                                                THEN 'Maori'
WHEN dl.LookupText = 'Ngai Tai (Tauranga Moana/Mataatua) '                                                                                THEN 'Maori'
WHEN dl.LookupText = 'Ngai Takoto '                                                                                                       THEN 'Maori'
WHEN dl.LookupText = 'Ngaiterangi '                                                                                                       THEN 'Maori'
WHEN dl.LookupText = 'Ngapuhi ki Whaingaroa-Ngati Kahu ki Whaingaroa'                                                                     THEN 'Maori'
WHEN dl.LookupText = 'Ngati Apa (Rangitikei) '                                                                                            THEN 'Maori'
WHEN dl.LookupText = 'Ngati Apa, area unspecified '                                                                                       THEN 'Maori'
WHEN dl.LookupText = 'Ngati Hako '                                                                                                        THEN 'Maori'
WHEN dl.LookupText = 'Ngati Haua, region unspecified '                                                                                    THEN 'Maori'
WHEN dl.LookupText = 'Ngati Hauiti '                                                                                                      THEN 'Maori'
WHEN dl.LookupText = 'Ngati Kahu'                                                                                                         THEN 'Maori'
WHEN dl.LookupText = 'Ngati Kahungunu ki Heretaunga '                                                                                     THEN 'Maori'
WHEN dl.LookupText = 'Ngati Kahungunu ki Tamatea '                                                                                        THEN 'Maori'
WHEN dl.LookupText = 'Ngati Kahungunu ki Wairarapa '                                                                                      THEN 'Maori'
WHEN dl.LookupText = 'Ngati Kahungunu ki Whanganui-a-Orotu '                                                                              THEN 'Maori'
WHEN dl.LookupText = 'Ngati Kahungunu, region unspecified '                                                                               THEN 'Maori'
WHEN dl.LookupText = 'Ngati Kuia '                                                                                                        THEN 'Maori'
WHEN dl.LookupText = 'Ngati Kuri'                                                                                                         THEN 'Maori'
WHEN dl.LookupText = 'Ngati Manawa '                                                                                                      THEN 'Maori'
WHEN dl.LookupText = 'Ngati Maniapoto '                                                                                                   THEN 'Maori'
WHEN dl.LookupText = 'Ngati Maru (Taranaki) '                                                                                             THEN 'Maori'
WHEN dl.LookupText = 'Ngati Maru, region unspecified '                                                                                    THEN 'Maori'
WHEN dl.LookupText = 'Ngati Mutunga (Taranaki) '                                                                                          THEN 'Maori'
WHEN dl.LookupText = 'Ngati Mutunga (Wharekauri/Chatham Islands) '                                                                        THEN 'Maori'
WHEN dl.LookupText = 'Ngati Mutunga, region unspecified '                                                                                 THEN 'Maori'
WHEN dl.LookupText = 'Ngati Paoa '                                                                                                        THEN 'Maori'
WHEN dl.LookupText = 'Ngati Pikiao (Te Arawa) '                                                                                           THEN 'Maori'
WHEN dl.LookupText = 'Ngati Porou '                                                                                                       THEN 'Maori'
WHEN dl.LookupText = 'Ngati Porou ki Harataunga ki Mataora '                                                                              THEN 'Maori'
WHEN dl.LookupText = 'Ngati Rakaipaaka '                                                                                                  THEN 'Maori'
WHEN dl.LookupText = 'Ngati Rangitihi (Te Arawa) '                                                                                        THEN 'Maori'
WHEN dl.LookupText = 'Ngati Rangiwewehi (Te Arawa) '                                                                                      THEN 'Maori'
WHEN dl.LookupText = 'Ngati Rarua '                                                                                                       THEN 'Maori'
WHEN dl.LookupText = 'Ngati Raukawa (Horowhenua/Manawatu) '                                                                               THEN 'Maori'
WHEN dl.LookupText = 'Ngati Raukawa (Waikato) '                                                                                           THEN 'Maori'
WHEN dl.LookupText = 'Ngati Raukawa, region unspecified '                                                                                 THEN 'Maori'
WHEN dl.LookupText = 'Ngati Ruanui '                                                                                                      THEN 'Maori'
WHEN dl.LookupText = 'Ngati Tahu-Ngati Whaoa (Te Arawa) '                                                                                 THEN 'Maori'
WHEN dl.LookupText = 'Ngati Tama (Te Waipounamu/South Island) '                                                                           THEN 'Maori'
WHEN dl.LookupText = 'Ngati Tamatera '                                                                                                    THEN 'Maori'
WHEN dl.LookupText = 'Ngati Tara Tokanui '                                                                                                THEN 'Maori'
WHEN dl.LookupText = 'Ngati Toa, region unspecified '                                                                                     THEN 'Maori'
WHEN dl.LookupText = 'Ngati Toarangatira (Te Whanganui a Tara/Wellington) '                                                               THEN 'Maori'
WHEN dl.LookupText = 'Ngati Wai '                                                                                                         THEN 'Maori'
WHEN dl.LookupText = 'Ngati Whakaue (Te Arawa) '                                                                                          THEN 'Maori'
WHEN dl.LookupText = 'Ngati Whare '                                                                                                       THEN 'Maori'
WHEN dl.LookupText = 'Ngati Whatua '                                                                                                      THEN 'Maori'
WHEN dl.LookupText = 'Pakakohi '                                                                                                          THEN 'Maori'
WHEN dl.LookupText = 'Polish'                                                                                                             THEN 'European'
WHEN dl.LookupText = 'Rangitane '                                                                                                         THEN 'Maori'
WHEN dl.LookupText = 'Rangitane (Manawatu) '                                                                                              THEN 'Maori'
WHEN dl.LookupText = 'Rangitane (Te Matau a Maui/Hawke''s Bay/Wairarapa) '                                                                THEN 'Maori'
WHEN dl.LookupText = 'Refused to Answer'                                                                                                  THEN 'Not Set'
WHEN dl.LookupText = 'Response outside scope '                                                                                            THEN 'Not Set'
WHEN dl.LookupText = 'Response Unidentifiable'                                                                                            THEN 'Other'
WHEN dl.LookupText = 'Rongowhakaata '                                                                                                     THEN 'Maori'
WHEN dl.LookupText = 'South Slav (formerly Yugoslav)'                                                                                     THEN 'European'
WHEN dl.LookupText = 'Southeast Asian'                                                                                                    THEN 'Asian'
WHEN dl.LookupText = 'Southeast Asian NFD'                                                                                                THEN 'Asian'
WHEN dl.LookupText = 'Sri Lankan'                                                                                                         THEN 'Asian'
WHEN dl.LookupText = 'Tainui '                                                                                                            THEN 'Maori'
WHEN dl.LookupText = 'Tapuika (Te Arawa) '                                                                                                THEN 'Maori'
WHEN dl.LookupText = 'Taranaki '                                                                                                          THEN 'Maori'
WHEN dl.LookupText = 'Tarawhai (Te Arawa) '                                                                                               THEN 'Maori'
WHEN dl.LookupText = 'Te Arawa '                                                                                                          THEN 'Maori'
WHEN dl.LookupText = 'Te Arawa/Taupo (Rotorua/Taupo) Region (nfd) '                                                                       THEN 'Maori'
WHEN dl.LookupText = 'Te Ati Haunui-a-Paparangi '                                                                                         THEN 'Maori'
WHEN dl.LookupText = 'Te Atiawa (Taranaki) '                                                                                              THEN 'Maori'
WHEN dl.LookupText = 'Te Atiawa (Te Waipounamu/South Island) '                                                                            THEN 'Maori'
WHEN dl.LookupText = 'Te Atiawa (Te Whanganui a Tara/Wellington) '                                                                        THEN 'Maori'
WHEN dl.LookupText = 'Te Atiawa, region unspecified '                                                                                     THEN 'Maori'
WHEN dl.LookupText = 'Te Aupouri'                                                                                                         THEN 'Maori'
WHEN dl.LookupText = 'Te Rarawa '                                                                                                         THEN 'Maori'
WHEN dl.LookupText = 'Te Roroa '                                                                                                          THEN 'Maori'
WHEN dl.LookupText = 'Te Tai Tokerau/Tamaki-makaurau (Northland/Auckland) Region (nfd)'                                                   THEN 'Maori'
WHEN dl.LookupText = 'Te Tauihu o Te Waka a Maui '                                                                                        THEN 'Maori'
WHEN dl.LookupText = 'Te Uri-o Hau '                                                                                                      THEN 'Maori'
WHEN dl.LookupText = 'Te Whanau-a-Apanui '                                                                                                THEN 'Maori'
WHEN dl.LookupText = 'Tokomaru '                                                                                                          THEN 'Maori'
WHEN dl.LookupText = 'Tuhourangi (Te Arawa) '                                                                                             THEN 'Maori'
WHEN dl.LookupText = 'Vietnamese'                                                                                                         THEN 'Asian'
WHEN dl.LookupText = 'Waikato '                                                                                                           THEN 'Maori'
WHEN dl.LookupText = 'Waikato/Te Rohe Potae (Waikato/King Country) Region (nfd) '                                                         THEN 'Maori'
WHEN dl.LookupText = 'Waitaha (Te Arawa) '                                                                                                THEN 'Maori'
WHEN dl.LookupText = 'Waitaha (Te Waipounamu/South Island) '                                                                              THEN 'Maori'
WHEN dl.LookupText = 'Asian nfd'                                                                                                          THEN 'Asian'
WHEN dl.LookupText = 'Indian'                                                                                                             THEN 'Asian'
WHEN dl.LookupText = 'Japanese'                                                                                                           THEN 'Asian'
WHEN dl.LookupText = 'Other Asian'                                                                                                        THEN 'Asian'
WHEN dl.LookupText = 'Other Southeast Asian'                                                                                              THEN 'Asian'
WHEN dl.LookupText = 'British and Irish'                                                                                                  THEN 'European'
WHEN dl.LookupText = 'Dutch'                                                                                                              THEN 'European'
WHEN dl.LookupText = 'European nfd'                                                                                                       THEN 'European'
WHEN dl.LookupText = 'German'                                                                                                             THEN 'European'
WHEN dl.LookupText = 'Italian'                                                                                                            THEN 'European'
WHEN dl.LookupText = 'Other European'                                                                                                     THEN 'European'
WHEN dl.LookupText = 'Other European NFD'                                                                                                 THEN 'European'
WHEN dl.LookupText = 'Hapu affiliated to more than one Iwi '                                                                              THEN 'Maori'
WHEN dl.LookupText = 'Ngai Tamanuhiri '                                                                                                   THEN 'Maori'
WHEN dl.LookupText = 'Ngapuhi'                                                                                                            THEN 'Maori'
WHEN dl.LookupText = 'Ngati Awa '                                                                                                         THEN 'Maori'
WHEN dl.LookupText = 'Ngati Haua (Taumarunui) '                                                                                           THEN 'Maori'
WHEN dl.LookupText = 'Ngati Haua (Waikato) '                                                                                              THEN 'Maori'
WHEN dl.LookupText = 'Ngati Kahungunu ki Te Wairoa '                                                                                      THEN 'Maori'
WHEN dl.LookupText = 'Ngati Pahauwera '                                                                                                   THEN 'Maori'
WHEN dl.LookupText = 'Ngati Pukenga '                                                                                                     THEN 'Maori'
WHEN dl.LookupText = 'Ngati Ranginui '                                                                                                    THEN 'Maori'
WHEN dl.LookupText = 'Ngati Tuwharetoa '                                                                                                  THEN 'Maori'
WHEN dl.LookupText = 'Rongomaiwahine (Te Mahia) '                                                                                         THEN 'Maori'
WHEN dl.LookupText = 'Te Aitanga-a-Mahaki '                                                                                               THEN 'Maori'
WHEN dl.LookupText = 'Te Tai Rawhiti (East Coast) Region nfd '                                                                            THEN 'Maori'
WHEN dl.LookupText = 'Tuhoe '                                                                                                             THEN 'Maori'
WHEN dl.LookupText = 'Whakatohea '                                                                                                        THEN 'Maori'
WHEN dl.LookupText = 'Middle Eastern'                                                                                                     THEN 'Other'
WHEN dl.LookupText = 'New Zealand European/Päkehä'                                                                                        THEN 'NZ European/Päkehä'
WHEN dl.LookupText = 'Don''t know '                                                                                                       THEN 'Not Set'
WHEN dl.LookupText = 'Not stated'                                                                                                         THEN 'Not Set'
WHEN dl.LookupText = 'Latin American/Hispanic'                                                                                            THEN 'Other'
WHEN dl.LookupText = 'Other'                                                                                                              THEN 'Other'
WHEN dl.LookupText = 'Cook Island Maori'                                                                                                  THEN 'Pacific'
WHEN dl.LookupText = 'Fijian'                                                                                                             THEN 'Pacific'
WHEN dl.LookupText = 'Niuean'                                                                                                             THEN 'Pacific'
WHEN dl.LookupText = 'Other Pacific Peoples'                                                                                              THEN 'Pacific'
WHEN dl.LookupText = 'Pacific Peoples nfd'                                                                                                THEN 'Pacific'
WHEN dl.LookupText = 'Samoan'                                                                                                             THEN 'Pacific'
WHEN dl.LookupText = 'Tokelauan'                                                                                                          THEN 'Pacific'
WHEN dl.LookupText = 'Tongan'                                                                                                             THEN 'Pacific'

                ELSE 'Not Set'
           END  as EthnicityGroupConsolidated
FROM            dl.DimLookup dl
INNER JOIN      dl.DimLookupGroup dlg     ON dl.LookupGroupID = dlg.LookupGroupID

LEFT OUTER JOIN dl.DimLookup      dlPar   ON dlPar.LookupID   = dl.LookupParentID
LEFT OUTER JOIN dl.DimLookupGroup dlgPar  ON dlPar.LookupGroupID = dlgPar.LookupGroupID  AND dlgPar.LookupGroupName  = 'Ethnicity'

WHERE      dlg.LookupGroupName     = 'Ethnicity'

GO

